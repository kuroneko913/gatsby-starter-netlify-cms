---
title: 海外FXの取引結果をFreeeにCSVで取り込んでみた。
date: 2021-02-11T09:43:56.460Z
description: 海外FXの取引結果を確定申告とやらをするために、会計アプリFreeeにアップロードした話。Freeeには、CSVアップロード機能があるので、MT4からダウンロードした取引結果をもとにCSVファイルを生成してアップロードした。
---
## はじめに

私は、海外FXを自動売買システムを使って行っています。
学生時代は、自分でFXの自動売買システムを作るんだ！と意気込んでいましたし、MQLを少し勉強していました。そして、取引ロジックを自分で見つけるのは難しすぎるということに気づいて以来、他人の作ったシステムを利用させていただき運用しています。

海外FXの自動売買では利益は(資金を増やした際の設定ミスにより)まったく出ていませんが、ふるさと納税と副業の収益に関しては、確定申告をする必要があったので、ついでにFXの損失申告もしておこうとなった次第です。その際に、会計アプリFreeeに取引損益を管理してもらえると一元管理ができて楽そうだったので、FX取引ソフトMT4での取引結果からCSVを生成し[Freee](https://www.freee.co.jp/)へ取り込みました。

## MT4での自動売買結果の取得

[MetaTrader4:MT4](https://www.metatrader4.com/ja)と呼ばれる取引ツールから、まず全取引履歴をダウンロードしました。

以下に示すのがVPS([Conoha](https://www.conoha.jp/vps/?btn_id=header_vps))上で動いているUbuntuにWineを入れて無理やり動かしているMetaTrader4というソフトです。いろいろとカラフルなグラフは、インジケータというもので、これをみながら取引のタイミングを探します。
(私は、今はつかってません、見た目がそれっぽいのでこれを選んだだけです笑)

![MetaTrader4](/images/uploaded/20210211-193738.png)

なぜか、CSVダウンロードがサポートされておらず、xlsファイル(Excel形式)をダウンロードして、GoogleSpreadSheetにアップロードしてCSVファイルに変換してダウンロードするという謎の工程を踏んでいます。
最終的に以下のようなファイルを得ました。取引開始時刻,取引終了時刻,取引種類(通貨ペア,buy or sell),損益などがまとまってます。この図の部分だとギリギリ負けてる気がする...... 

![実際の取引CSV](/images/uploaded/20210211-200044.png)

## 会計freeeに取引損益をCSVでアップロードする

まず、損益管理のために、Freeeに現金の口座(FX収益)を登録しました。この現金の口座を登録することで柔軟な資金管理が可能になると思います。

この登録した口座に、[取引・口座振替のインポート](https://support.freee.co.jp/hc/ja/articles/202847320?_ga=2.130420360.684241821.1613031431-1312080387.1612684829)を参考に、提供されている雛形CSVファイル形式のデータをアップロードすることで連携を実現します。

今回作るCSVファイルには、以下のような項目があります。

「収支区分,管理番号,発生日,決済期日,取引先コード,取引先,勘定科目,税区分,金額,税計算区分,税額,備考,品目,部門,メモタグ（複数指定可、カンマ区切り）,セグメント1,セグメント2,セグメント3,決済日,決済口座,決済金額」
